<html lang="en">
<head>
    <title>Generate QR code</title>
    <script
            src="https://cdn.jsdelivr.net/npm/easyqrcodejs@4.6.1/dist/easy.qrcode.min.js"
            integrity="sha256-Fo2ReOrm4CpFeRT3gEiA303kO8giOmwEkm6uz3+6DBg="
            crossorigin="anonymous">
    </script>
    <style>
        div, input, table {margin: 12px 8px}
        table {border: 1px dashed}
        td {padding: 2px 4px;vertical-align: text-bottom;}
        .qr-container {
            background-color: #DDD;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 250px;
        }
    </style>
</head>
<body>
<h1>Generate QR code</h1>
<h2 style="font-style: italic">WIP - only partly implemented</h2>
<p>Using <a href="https://www.jsdelivr.com/package/npm/easyqrcodejs">easyqrcodejs</a></p>
<table>
    <tr>
        <td>
            <label for="qr-text">Content</label>
        </td>
        <td>
            <input type="text" id="qr-text" value="1234">
        </td>
    </tr>
    <tr>
        <td>
            <label for="qr-size-slider">Size</label>
        </td>
        <td>
            <input type="range" id="qr-size-slider" min="100" max="2000" value="250"/>
            <input type="number" id="qr-size-input" min="100" max="2000" value="250"/>
        </td>
    </tr>
    <tr>
        <td>
            <label for="qr-size-slider">Spacing X</label>
        </td>
        <td>
            <input type="range" id="qr-spacing-width-slider" min="0" max="800" value="0"/>
            <input type="number" id="qr-spacing-width-input" min="0" max="800" value="0"/>
        </td>
    </tr>
    <tr>
        <td>
            <label for="qr-size-slider">Spacing Y</label>
        </td>
        <td>
            <input type="range" id="qr-spacing-height-slider" min="0" max="800" value="0"/>
            <input type="number" id="qr-spacing-height-input" min="0" max="800" value="0"/>
        </td>
    </tr>
    <tr>
        <td>
            <label for="qr-data-dot-color-selector">Foreground</label>
        </td>
        <td>
            <input type="color" id="qr-data-dot-color-selector" value="#000000"/>
        </td>
    </tr>
    <tr>
        <td>
            <label for="qr-background-color-selector">Background</label>
        </td>
        <td>
            <input type="color" id="qr-background-color-selector" value="#ffffff"/>
        </td>
    </tr>
    <tr>
        <td>
            <label for="spacing-color-selector">Spacing</label>
        </td>
        <td>
            <input type="color" id="spacing-color-selector" value="#DDDDDD"/>
        </td>
    </tr>
    <tr>
        <td>
            <label for="timing-horizontal-color-selector">Timing X</label>
        </td>
        <td>
            <input type="color" id="timing-horizontal-color-selector" value="#000000"/>
        </td>
    </tr>
    <tr>
        <td>
            <label for="timing-vertical-color-selector">Timing Y</label>
        </td>
        <td>
            <input type="color" id="timing-vertical-color-selector" value="#000000"/>
        </td>
    </tr>
</table>
<div id="qr-container" class="qr-container"></div>
<script type="text/javascript">
  let options = {
    text: "1234",
    width: 250,
    height: 250,
    colorDark: "#000000",
    colorLight: "#ffffff",
    correctLevel: QRCode.CorrectLevel.H, // L, M, Q, H
    dotScale: .8,
    dotScaleTiming: 0.8,
    dotScaleTiming_H: 0.8,
    dotScaleTiming_V: 0.8,
    dotScaleA: 0.2,
    dotScaleAO: 0.2,
    dotScaleAI: 0.2,
    quietZone: 0,
    quietZoneColor: "rgba(0,0,0,0)",
    binary: false,
    PO: '#000000', // Global Position Outer color. if not set, the defaut is `colorDark`
    PI: '#000000', // Global Position Inner color. if not set, the defaut is `colorDark`
    PO_TL: '', // Position Outer color - Top Left
    PI_TL: '', // Position Inner color - Top Left
    PO_TR: '', // Position Outer color - Top Right
    PI_TR: '', // Position Inner color - Top Right
    PO_BL: '#000000', // Position Outer color - Bottom Left
    PI_BL: '', // Position Inner color - Bottom Left
    AO: '', // Alignment Outer. if not set, the defaut is `colorDark`
    AI: '', // Alignment Inner. if not set, the defaut is `colorDark`
    timing: '#D00', // Global Timing color. if not set, the defaut is `colorDark`
    timing_H: '#000000', // Horizontal timing color
    timing_V: '#000000', // Vertical timing color
    logo: "",
    //logoWidth: 40, // fixed logo width. default is `width/3.5`
    //logoHeight: 40, // fixed logo height. default is `heigth/3.5`
    logoBackgroundColor: '#fffff', // Logo backgroud color, Invalid when `logBgTransparent` is true; default is '#ffffff'
    logoMaxWidth: undefined, // Maximum logo width. if set will ignore `logoWidth` value
    logoMaxHeight: undefined, // Maximum logo height. if set will ignore `logoHeight` value
    logoBackgroundTransparent: true, // Whether use transparent image, default is false
  }

  const elements = {
    qrContainer: document.getElementById('qr-container'),
    qrSizeSlider: document.getElementById('qr-size-slider'),
    qrSizeInput: document.getElementById('qr-size-input'),
    qrSpacingWidthSlider: document.getElementById('qr-spacing-width-slider'),
    qrSpacingWidthInput: document.getElementById('qr-spacing-width-input'),
    qrSpacingHeightSlider: document.getElementById('qr-spacing-height-slider'),
    qrSpacingHeightInput: document.getElementById('qr-spacing-height-input'),
    qrColorForegroundSelector: document.getElementById('qr-data-dot-color-selector'),
    qrColorBackgroundSelector: document.getElementById('qr-background-color-selector'),
    qrColorSpacingSelector: document.getElementById('spacing-color-selector'),
    qrColorTimingHorizontalSelector: document.getElementById('timing-horizontal-color-selector'),
    qrColorTimingVerticalSelector: document.getElementById('timing-vertical-color-selector'),
  }

  let QR
  const drawQrCode = () => {
    elements.qrContainer.innerHTML = null
    QR = new QRCode(document.getElementById("qr-container"), options)
  }

  document.getElementById('qr-text').addEventListener('input', e => {
    options.text = e.currentTarget.value
    drawQrCode()
  })

  elements.qrSizeSlider.addEventListener('input', e => {
    options.width = e.currentTarget.value
    options.height = e.currentTarget.value
    elements.qrSizeInput.value = e.currentTarget.value
    drawQrCode()
  })
  elements.qrSizeInput.addEventListener('input', e => {
    options.width = e.currentTarget.value
    options.height = e.currentTarget.value
    elements.qrSizeSlider.value = e.currentTarget.value
    drawQrCode()
  })

  elements.qrColorBackgroundSelector.addEventListener('input', e => {
    options.colorLight = e.currentTarget.value
    drawQrCode()
  })

  elements.qrColorForegroundSelector.addEventListener('input', e => {
    options.colorDark = e.currentTarget.value
    drawQrCode()
  })

  elements.qrColorTimingHorizontalSelector.addEventListener('input', e => {
    options.timing_H = e.currentTarget.value
    drawQrCode()
  })

  elements.qrColorTimingVerticalSelector.addEventListener('input', e => {
    options.timing_V = e.currentTarget.value
    drawQrCode()
  })

  elements.qrColorSpacingSelector.addEventListener('input', e => {
    elements.qrContainer.style.backgroundColor = e.currentTarget.value
  })

  elements.qrSpacingHeightSlider.addEventListener('input', e => {
    elements.qrSpacingHeightInput.value = e.currentTarget.value
    const spacing = Number.parseInt(e.currentTarget.value)
    const qrHeight = QR._htOption.height
    elements.qrContainer.style.height = `${spacing + qrHeight}px`
  })
  elements.qrSpacingHeightInput.addEventListener('input', e => {
    elements.qrSpacingHeightSlider.value = e.currentTarget.value
    const spacing = Number.parseInt(e.currentTarget.value)
    const qrHeight = QR._htOption.height
    elements.qrContainer.style.height = `${spacing + qrHeight}px`
  })

  elements.qrSpacingWidthSlider.addEventListener('input', e => {
    elements.qrSpacingWidthInput.value = e.currentTarget.value
    const spacing = Number.parseInt(e.currentTarget.value)
    const qrWidth = QR._htOption.width
    elements.qrContainer.style.width = `${spacing + qrWidth}px`
  })
  elements.qrSpacingWidthInput.addEventListener('input', e => {
    elements.qrSpacingWidthSlider.value = e.currentTarget.value
    const spacing = Number.parseInt(e.currentTarget.value)
    const qrWidth = QR._htOption.width
    elements.qrContainer.style.width = `${spacing + qrWidth}px`
  })

  drawQrCode()
</script>
</body>
</html>
